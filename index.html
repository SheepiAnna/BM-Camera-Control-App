<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>ORBES Camera</title>
    <meta name="description" content="Blackmagic camera control for Orbital Exploration Systems">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body onload="bodyOnLoad()">
    <script src="BMDevice.js"></script>
    <script src="web-ui.js"></script>

    <!-- Header -->
    <header id="headerContainer">
        <div class="orbes-logo">
            <svg viewBox="0 0 70 51" fill="none">
                <path d="M0 12C0 2.77 3.57 0 15.59 0C27.61 0 31.17 2.65 31.17 11.88C31.17 21.11 27.61 23.75 15.59 23.75C3.57 23.75 0 20.99 0 11.88V12Z" fill="#B7BCFF"/>
                <path d="M34.5 12C34.5 2.77 38.07 0.14 50.09 0.14C62.11 0.14 65.68 2.78 65.68 12.01C65.68 21.24 62.11 23.89 50.09 23.89C38.07 23.89 34.5 21.12 34.5 12.01Z" fill="#B7BCFF"/>
                <path d="M0 38.73C0 29.49 3.57 26.86 15.59 26.86C27.61 26.86 31.17 29.5 31.17 38.73C31.17 47.96 27.61 50.61 15.59 50.61C3.57 50.61 0 47.84 0 38.73Z" fill="#B7BCFF"/>
                <path d="M34.5 38.73C34.5 29.49 38.07 26.86 50.09 26.86C62.11 26.86 65.68 29.5 65.68 38.73C65.68 47.96 62.11 50.61 50.09 50.61C38.07 50.61 34.5 47.84 34.5 38.73Z" fill="#B7BCFF"/>
            </svg>
        </div>
        <h1 id="cameraName">Not Connected</h1>
        <div id="statusDot" class="status-disconnected"></div>
    </header>

    <!-- Main Content -->
    <main id="mainContent">
        
        <!-- Connection Card -->
        <section class="card" id="connectionCard">
            <div class="card-header">
                <span class="card-icon">üì°</span>
                <h2>Connect Camera</h2>
            </div>
            <div class="card-body">
                <input type="text" id="hostnameInput" placeholder="Camera-Name.local" onclick="hostnameInputHandler()" onkeydown="hostnameInputHandler()">
                <div class="row">
                    <label class="checkbox-label">
                        <input type="checkbox" id="secureCheckbox">
                        <span>HTTPS</span>
                    </label>
                    <button class="btn-primary" onclick="initCamera()">Connect</button>
                </div>
                <p id="connectionErrorSpan" class="error-text"></p>
            </div>
        </section>

        <!-- Transport Controls -->
        <section class="card" id="transportCard">
            <div class="card-header">
                <span class="card-icon">üé¨</span>
                <h2>Transport</h2>
                <span id="timecodeLabel" class="timecode">00:00:00:00</span>
            </div>
            <div class="card-body">
                <div class="transport-grid">
                    <button class="transport-btn" onclick="cameras[ci].seek(false)" title="Previous">‚èÆ</button>
                    <button class="transport-btn" onclick="cameras[ci].stop()" title="Stop">‚èπ</button>
                    <button class="transport-btn record-btn" onclick="cameras[ci].toggleRecord()" title="Record">‚è∫</button>
                    <button class="transport-btn" onclick="cameras[ci].play()" title="Play">‚ñ∂</button>
                    <button class="transport-btn" onclick="cameras[ci].seek(true)" title="Next">‚è≠</button>
                </div>
                <div id="formatDisplay" class="format-row">
                    <span id="formatCodec">--</span>
                    <span id="formatResolution">--</span>
                    <span id="formatFPS">--</span>
                </div>
            </div>
        </section>

        <!-- Exposure Controls -->
        <section class="card" id="exposureCard">
            <div class="card-header">
                <span class="card-icon">‚òÄÔ∏è</span>
                <h2>Exposure</h2>
                <button class="btn-small" onclick="cameras[ci].doAutoWhitebalance()">AWB</button>
            </div>
            <div class="card-body">
                <div class="exposure-grid" id="cameraControlExposureContainer">
                    <div class="exposure-item">
                        <span class="exposure-label">ND</span>
                        <div class="exposure-control">
                            <button class="adj-btn" onclick="decreaseND()">‚àí</button>
                            <span id="ndFilterSpan" class="exposure-value" contenteditable="plaintext-only" onkeydown="NDFilterInputHandler()" onmousedown="NDFilterInputHandler()">0</span>
                            <button class="adj-btn" onclick="increaseND()">+</button>
                        </div>
                    </div>
                    <div class="exposure-item">
                        <span class="exposure-label">GAIN</span>
                        <div class="exposure-control">
                            <button class="adj-btn" onclick="decreaseGain()">‚àí</button>
                            <span id="gainSpan" class="exposure-value" contenteditable="plaintext-only" onkeydown="GainInputHandler()" onmousedown="GainInputHandler()">0dB</span>
                            <button class="adj-btn" onclick="increaseGain()">+</button>
                        </div>
                    </div>
                    <div class="exposure-item">
                        <span class="exposure-label">SHUTTER</span>
                        <div class="exposure-control">
                            <button class="adj-btn" onclick="decreaseShutter()">‚àí</button>
                            <span id="shutterSpan" class="exposure-value" contenteditable="plaintext-only" onkeydown="handleShutterInput()" onmousedown="handleShutterInput()">1/50</span>
                            <button class="adj-btn" onclick="increaseShutter()">+</button>
                        </div>
                    </div>
                    <div class="exposure-item">
                        <span class="exposure-label" id="WBLabel" onclick="swapWBMode()">WB</span>
                        <div class="exposure-control" id="WBValueContainer">
                            <button class="adj-btn" onclick="decreaseWhiteBalance()">‚àí</button>
                            <span id="whiteBalanceSpan" class="exposure-value" contenteditable="plaintext-only" onkeydown="WBInputHandler()" onmousedown="WBInputHandler()">5600K</span>
                            <button class="adj-btn" onclick="increaseWhiteBalance()">+</button>
                        </div>
                        <div class="exposure-control dNone" id="WBTintValueContainer">
                            <button class="adj-btn" onclick="decreaseWhiteBalanceTint()">‚àí</button>
                            <span id="whiteBalanceTintSpan" class="exposure-value" contenteditable="plaintext-only" onkeydown="WBTInputHandler()" onmousedown="WBTInputHandler()">0</span>
                            <button class="adj-btn" onclick="increaseWhiteBalanceTint()">+</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Lens Controls -->
        <section class="card" id="lensCard">
            <div class="card-header">
                <span class="card-icon">üî≠</span>
                <h2>Lens</h2>
                <button class="btn-small" onclick="cameras[ci].doAutoFocus()">AF</button>
            </div>
            <div class="card-body">
                <div class="lens-grid" id="cameraControlLensContainer">
                    <div class="lens-item">
                        <span class="lens-label">FOCUS</span>
                        <input type="range" class="slider-h" min="0" max="1" step="0.001" id="focusRange" oninput="cameras[ci].PUTdata('/lens/focus', {normalised: parseFloat(this.value)})">
                    </div>
                    <div class="lens-item">
                        <span class="lens-label">IRIS</span>
                        <input type="range" class="slider-h" min="0" max="1" step="0.001" id="irisRange" oninput="cameras[ci].PUTdata('/lens/iris', {normalised: parseFloat(this.value)})">
                        <span id="apertureStopsLabel" class="lens-value">f/--</span>
                    </div>
                    <div class="lens-item">
                        <span class="lens-label">ZOOM</span>
                        <input type="range" class="slider-h" min="0" max="1" step="0.001" id="zoomRange" oninput="cameras[ci].PUTdata('/lens/zoom', {normalised: parseFloat(this.value)})">
                        <span id="zoomMMLabel" class="lens-value">--mm</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Color Correction (Collapsed by default) -->
        <section class="card collapsible" id="colorCard">
            <div class="card-header" onclick="this.parentElement.classList.toggle('expanded')">
                <span class="card-icon">üé®</span>
                <h2>Color</h2>
                <span class="collapse-icon">‚ñº</span>
            </div>
            <div class="card-body collapse-content" id="cameraControlColorCorrectionContainer">
                <!-- Lift -->
                <div class="cc-row">
                    <span class="cc-label">Lift</span>
                    <div class="cc-values" id="cameraControlColorCorrectionNumbersContainer">
                        <span contenteditable="plaintext-only" class="CClumaLabel cc-val" onmousedown="CCInputHandler(0)" onkeydown="CCInputHandler(0)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCredLabel cc-val cc-red" onmousedown="CCInputHandler(0)" onkeydown="CCInputHandler(0)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCgreenLabel cc-val cc-green" onmousedown="CCInputHandler(0)" onkeydown="CCInputHandler(0)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCblueLabel cc-val cc-blue" onmousedown="CCInputHandler(0)" onkeydown="CCInputHandler(0)">0.00</span>
                    </div>
                    <button class="btn-icon" onclick="resetCC(0)">‚Ü∫</button>
                </div>
                <!-- Gamma -->
                <div class="cc-row">
                    <span class="cc-label">Gamma</span>
                    <div class="cc-values">
                        <span contenteditable="plaintext-only" class="CClumaLabel cc-val" onmousedown="CCInputHandler(1)" onkeydown="CCInputHandler(1)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCredLabel cc-val cc-red" onmousedown="CCInputHandler(1)" onkeydown="CCInputHandler(1)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCgreenLabel cc-val cc-green" onmousedown="CCInputHandler(1)" onkeydown="CCInputHandler(1)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCblueLabel cc-val cc-blue" onmousedown="CCInputHandler(1)" onkeydown="CCInputHandler(1)">0.00</span>
                    </div>
                    <button class="btn-icon" onclick="resetCC(1)">‚Ü∫</button>
                </div>
                <!-- Gain -->
                <div class="cc-row">
                    <span class="cc-label">Gain</span>
                    <div class="cc-values">
                        <span contenteditable="plaintext-only" class="CClumaLabel cc-val" onmousedown="CCInputHandler(2)" onkeydown="CCInputHandler(2)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCredLabel cc-val cc-red" onmousedown="CCInputHandler(2)" onkeydown="CCInputHandler(2)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCgreenLabel cc-val cc-green" onmousedown="CCInputHandler(2)" onkeydown="CCInputHandler(2)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCblueLabel cc-val cc-blue" onmousedown="CCInputHandler(2)" onkeydown="CCInputHandler(2)">0.00</span>
                    </div>
                    <button class="btn-icon" onclick="resetCC(2)">‚Ü∫</button>
                </div>
                <!-- Offset -->
                <div class="cc-row">
                    <span class="cc-label">Offset</span>
                    <div class="cc-values">
                        <span contenteditable="plaintext-only" class="CClumaLabel cc-val" onmousedown="CCInputHandler(3)" onkeydown="CCInputHandler(3)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCredLabel cc-val cc-red" onmousedown="CCInputHandler(3)" onkeydown="CCInputHandler(3)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCgreenLabel cc-val cc-green" onmousedown="CCInputHandler(3)" onkeydown="CCInputHandler(3)">0.00</span>
                        <span contenteditable="plaintext-only" class="CCblueLabel cc-val cc-blue" onmousedown="CCInputHandler(3)" onkeydown="CCInputHandler(3)">0.00</span>
                    </div>
                    <button class="btn-icon" onclick="resetCC(3)">‚Ü∫</button>
                </div>
            </div>
        </section>

        <!-- Settings (Collapsed by default) -->
        <section class="card collapsible" id="settingsCard">
            <div class="card-header" onclick="this.parentElement.classList.toggle('expanded')">
                <span class="card-icon">‚öôÔ∏è</span>
                <h2>Settings</h2>
                <span class="collapse-icon">‚ñº</span>
            </div>
            <div class="card-body collapse-content" id="cameraControlExpandedBodyContainer">
                <div class="setting-row">
                    <label>ISO</label>
                    <input type="number" id="ISOInput" step="100" onkeydown="ISOInputHandler()" onmousedown="unsavedChanges.push('ISO')">
                </div>
                <div class="setting-row">
                    <label>AE Mode</label>
                    <select id="AEmodeDropDown" onmousedown="unsavedChanges.push('AutoExposure')">
                        <option value="Off">Off</option>
                        <option value="Continuous">Continuous</option>
                        <option value="OneShot">One-Shot</option>
                    </select>
                </div>
                <div class="setting-row">
                    <label>AE Type</label>
                    <select id="AEtypeDropDown" onmousedown="unsavedChanges.push('AutoExposure')">
                        <option value="">None</option>
                        <option value="Iris">Iris Only</option>
                        <option value="Shutter">Shutter Only</option>
                        <option value="Shutter,Iris">Shutter + Iris</option>
                    </select>
                </div>
                <button class="btn-primary" onclick="AEmodeInputHandler()">Apply</button>
                
                <div class="divider"></div>
                
                <div class="setting-row">
                    <label>Preset</label>
                    <select id="presetsDropDown" onmousedown="unsavedChanges.push('presets')" onchange="presetInputHandler()"></select>
                </div>
                <button class="btn-secondary" onclick="presetInputHandler()">Load Preset</button>
            </div>
        </section>

        <!-- Camera Selector (hidden by default, for multi-cam) -->
        <div id="cameraSelectContainer" class="dNone">
            <span class="cameraSwitchLabel selectedCam"><a href="#" onclick="switchCamera(0)">1</a></span>
            <span class="cameraSwitchLabel"><a href="#" onclick="switchCamera(1)">2</a></span>
            <span class="cameraSwitchLabel"><a href="#" onclick="switchCamera(2)">3</a></span>
            <span class="cameraSwitchLabel"><a href="#" onclick="switchCamera(3)">4</a></span>
        </div>

    </main>

    <!-- Hidden elements for compatibility -->
    <div class="dNone">
        <span id="cameraNumberLabel"></span>
        <div id="cameraControlHeadContainer"></div>
        <div id="cameraControlsContainer"></div>
        <div id="cameraControlsContainerExpanded"></div>
        <div id="allCamerasContainer"></div>
        <div id="footerContainer"></div>
        <span id="documentationLink"></span>
        <span id="mediaManagerLink"></span>
        <button id="loopButton"></button>
        <button id="singleClipButton"></button>
        <button id="CCHamburgerButton"></button>
        <input id="CCcontrastPivotRange">
        <input id="CCcontrastAdjustRange">
        <input id="CChueRange">
        <input id="CCsaturationRange">
        <input id="CClumaContributionRange">
        <span id="CCcontrastPivotLabel"></span>
        <span id="CCcontrastAdjustLabel"></span>
        <span id="CCcolorHueLabel"></span>
        <span id="CCcolorSatLabel"></span>
        <span id="CCcolorLCLabel"></span>
        <input id="manualRequestEndpointLabel">
        <input id="manualRequestBodyLabel">
        <input id="requestTypeGET">
        <input id="requestTypePUT">
        <span id="manualRequestResponseP"></span>
        <button id="AWBButton"></button>
        <button id="AFButton"></button>
    </div>

</body>
</html>
